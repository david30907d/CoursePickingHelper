<!DOCTYPE html>
<html lang="zh-tw" class="han-la">   
<!--  
//                                  _oo8oo_
//                                 o8888888o
//                                 88" . "88
//                                 (| -_- |)
//                                 0\  =  /0
//                               ___/'==='\___
//                             .' \\|     |// '.
//                            / \\|||  :  |||// \
//                           / _||||| -:- |||||_ \
//                          |   | \\\  -  /// |   |
//                          | \_|  ''\---/''  |_/ |
//                          \  .-\__  '-'  __/-.  /
//                        ___'. .'  /--.--\  '. .'___
//                     ."" '<  '.___\_<|>_/___.'  >' "".
//                    | | :  `- \`.:`\ _ /`:.`/ -`  : | |
//                    \  \ `-.   \_ __\ /__ _/   .-` /  /
//                =====`-.____`.___ \_____/ ___.`____.-`=====
//                                  `=---=`
//  
//  
//                       佛祖保佑  　　　　　永無bug
-->             
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>選課小幫手</title>
        <script type="text/javascript"></script>
        <link href="https://cdnjs.cloudflare.com/ajax/libs/Han/2.3.0/han.css" rel="stylesheet">
        <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
        <link href="font-awesome-4.3.0/css/font-awesome.min.css" rel="stylesheet">
        <!--<script src="https://cdnjs.cloudflare.com/ajax/libs/Han/2.3.0/han.js"></script>-->
        
        <style>
        /*這裡開始是我寫的，選取表單和選單上的id，並把顏色反白*/
        #icon-text, #icon-text1, #icon-text2, #icon-text3, #icon-text4, #icon-text5
        {
        	color: white;
        	font-family: "Microsoft JhengHei";
        	font-size: 100%;
        	font-style: italic;
        }
        body
        {
        	background-color:#3074B5;
        	background-repeat:no-repeat;
        	background-attachment: fixed;
        	font-family: "Microsoft JhengHei";
        }
        /*最後改的p是相簿的英文字*/
        #btn-tools
        {
        	padding: 0;
        }
        #classification
        {
        	padding: 0px;
        }
		/*修改table的border*/
        #time-table tbody th
        {
        	white-space: nowrap;
        	font-size: 80%;
        	height:55px;
        }
        #time-table th
        {
        	text-align: center;
        }
        #time-table button.btn-link
        {
        	text-align: center;
        	color:black;
        }
        #time-table div.title
        {
        	text-align: center;
        	font-size: 120%;
        	padding-bottom: 3px;
        }
        #time-table div.location
        {
        	text-align: left;
        	font-size: 80%;
        }
        #time-table div.professor
        {
        	text-align: right;
        	font-size: 80%;
        }
        /*table的屬性結束*/
        .search-class .panel-body
        {
            padding-top: 0;
            padding-bottom  : 0;
        }
        .search-class .panel-body h5:hover,
        .search-class .panel-body h5:focus
        {
            background-color: #BACAD2;
        }
        </style>
    </head>

    <body>

        <!--選取系級的表單結束-->
        <div class="container-fluid">
            <div class="col-md-9">              	          
                <div class="panel panel-success" id="curriculum-title">
			        <div class="panel-heading row">
						<div class="col-xs-7">
							<h2 style="text-align:right;" id="curriculum-title">課表</h2>
						</div>
							
						<div class="col-xs-5" style="text-align:right;">
							<h4>
								<span class="glyphicon glyphicon-user" ></span>
								 學分：<span class="badge" id="class_credit"></span>
							</h4>
						</div>
			          
			        </div>			        
		      	</div>
				<button type="button" class="btn btn-default" data-toggle="tooltip" data-placement="bottom" title="fuckfuck pastelo">Tooltip on left</button>

                <div class="table-responsive" id="time-table">
                    <table class="table table-striped table-hover table-condensed table-bordered">
                        <thead>
                            <tr class="info">
                                <th style="width: 1px">時間</th>
                                <th style="width: 20%">一</th>
                                <th style="width: 20%">二</th>
                                <th style="width: 20%">三</th>
                                <th style="width: 20%">四</th>
                                <th style="width: 20%">五</th>
                            </tr>
                        </thead>
                        <tbody>
								<tr data-hour="1" class="active">
									<th>08:10 - 09:00</th>
									<td data-day="1"></td>
									<td data-day="2"></td>
									<td data-day="3"></td>
									<td data-day="4"></td>
									<td data-day="5"></td>
								</tr>
								<tr data-hour="2" class="active">
									<th>09:10 - 10:00</th>
									<td data-day="1"></td>
									<td data-day="2"></td>
									<td data-day="3"></td>
									<td data-day="4"></td>
									<td data-day="5"></td>
								</tr>
								<tr data-hour="3" class="active">
									<th>10:10 - 11:00</th>
									<td data-day="1"></td>
									<td data-day="2"></td>
									<td data-day="3"></td>
									<td data-day="4"></td>
									<td data-day="5"></td>
								</tr>
								<tr data-hour="4" class="active">
									<th>11:10 - 12:00</th>
									<td data-day="1"></td>
									<td data-day="2"></td>
									<td data-day="3"></td>
									<td data-day="4"></td>
									<td data-day="5"></td>
								</tr>
								<tr data-hour="5" class="active">
									<th>13:10 - 14:00</th>
									<td data-day="1"></td>
									<td data-day="2"></td>
									<td data-day="3"></td>
									<td data-day="4"></td>
									<td data-day="5"></td>
								</tr>
								<tr data-hour="6" class="active">
									<th>14:10 - 15:00</th>
									<td data-day="1"></td>
									<td data-day="2"></td>
									<td data-day="3"></td>
									<td data-day="4"></td>
									<td data-day="5"></td>
								</tr>
								<tr data-hour="7" class="active">
									<th>15:10 - 16:00</th>
									<td data-day="1"></td>
									<td data-day="2"></td>
									<td data-day="3"></td>
									<td data-day="4"></td>
									<td data-day="5"></td>
								</tr>
								<tr data-hour="8" class="active">
									<th>16:10 - 17:00</th>
									<td data-day="1"></td>
									<td data-day="2"></td>
									<td data-day="3"></td>
									<td data-day="4"></td>
									<td data-day="5"></td>
								</tr>
							</tbody>
                    </table>
                </div>
            </div>
            <br>
            <!--會出現系選修和體育、通識-->
            <div class="col-md-3" id="classification">
                <div class="container-fluid">
                    <div class="col-xs-4" id="btn-tools">
                        <button type="button" class="btn btn-danger btn-block" data-toggle="modal" data-target="#focus">
                        <span class="fa fa-heart fa-1x fa-fw"></span>
                        </button>
                    </div>
                    <div class="col-xs-4" id="btn-tools">
                        <button type="button" class="btn btn-success btn-block" data-toggle="modal" data-target="#search">
                        <span class="fa fa-search fa-1x fa-fw"></span>
                        </button>
                    </div>
                    <div class="col-xs-4" id="btn-tools">
                        <button type="button" class="btn btn-warning btn-block" id="clear-button">
                        <span class="fa fa-trash fa-1x fa-fw"></span>
                        </button>
                    </div>
                </div>
                <br>
                <!--側欄位-->
                <div class="search-class" id="bulletin-post">
					<div class="panel panel-info">
						<div class="panel-heading">必修<button type="button" class="close"><span class="fa fa-trash"></span></button>
						</div>
						<div class="panel-body">
							<h5>Class1</h5>
							<h5>Class2</h5>
							<h5>Class3</h5>
							<h5>Class4</h5>
						</div>
	                </div>
						<div class="panel panel-info">
							<div class="panel-heading">選擇性必修<button type="button" class="close"><span class="fa fa-trash"></span></button>
							</div>
							<div class="panel-body" id="obligatory-post">
						</div>
					</div>
					<div class="panel panel-info">
						<div class="panel-heading">選修<button type="button" class="close"><span class="fa fa-trash"></span></button>
						</div>
						<div class="panel-body" id="elective-post">
							<h5>一年級</h5>
                            <div id="freshman">
							</div>
							<h5>二年級</h5>
							<div id="sophomore">
							</div>
							<h5>三年級</h5>
							<div id="junior">
							</div>
							<h5>四年級</h5>
							<div id="senior">
							</div>
							<h5>五年級</h5>
							<div id="fifth-grade">
							</div>
						</div>
					</div>
					<div class="panel panel-info">
						<div class="panel-heading">通識<button type="button" class="close"><span class="fa fa-trash"></span></button>
						</div>
						<div class="panel-body" id="general-post">

						</div>
					</div>
					<div class="panel panel-info">
						<div class="panel-heading">體育<button type="button" class="close"><span class="fa fa-trash"></span></button>
						</div>
						<div class="panel-body" id="PE-post">
						</div>
					</div>
                </div>

                <div class="modal fade modal fade bs-example-modal-lg" id="focus" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                    <div class="modal-dialog modal-lg">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                <h3 class="modal-title" id="myModalLabel"><span class="fa fa-heart fa-1x fa-fw"></span>選擇科系</h3>
                            </div>
                            
                        <div class="modal-body">
                            <form class="form-horizontal">
                                <div class="form-group">
                                    <label for="v_career" class="col-xs-2 control-label">學制</label>
                                    <div class="col-xs-10">
                                        <select class="form-control" name="v_career" id="v_career">
                                            <option value="0">請選擇學制</option>
                                            <option value="U">學士班</option>
                                            <option value="G">碩士班</option>
                                            <option value="D">博士班</option>
                                            <option value="R">產專班</option>
                                            <option value="W">碩專班</option>
                                            <option value="N">進修學士班</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="v_major" class="col-xs-2 control-label">系所</label>
                                    <div class="col-xs-10">
                                        <select class="form-control" name="v_major" id="v_major">
                                            <option>請選擇系所</option>
                                            <option>文學院</option>
                                            <option>管理學院</option>
                                            <option>農業暨自然資源學院</option>
                                            <option>中國文學系學士班</option>
                                            <option>外國語文學系學士班</option>
                                            <option>歷史學系學士班</option>
                                            <option>財務金融學系學士班</option>
                                            <option>企業管理學系學士班</option>
                                            <option>法律學系學士班</option>
                                            <option>會計學系學士班</option>
                                            <option>資訊管理學系學士班</option>
                                            <option>景觀與遊憩學士學位學程</option>
                                            <option>生物科技學士學位學程</option>
                                            <option>國際農企業學士學位學程</option>
                                            <option>農藝學系學士班</option>
                                            <option>園藝學系學士班</option>
                                            <option>森林學系林學組學士班</option>
                                            <option>森林學系木材科學組學士班</option>
                                            <option>應用經濟學系學士班</option>
                                            <option>植物病理學系學士班</option>
                                            <option>昆蟲學系學士班</option>
                                            <option>動物科學系學士班</option>
                                            <option>獸醫學系學士班</option>
                                            <option>獸醫學系學士班</option>
                                            <option>土壤環境科學系學士班</option>
                                            <option>生物產業機電工程學系學士班</option>
                                            <option>水土保持學系學士班</option>
                                            <option>食品暨應用生物科技學系學士班</option>
                                            <option>行銷學系學士班</option>
                                            <option>化學系學士班</option>
                                            <option>生命科學系學士班</option>
                                            <option>應用數學系學士班</option>
                                            <option>應用數學系學士班</option>
                                            <option>物理學系一般物理組學士班</option>
                                            <option>物理學系光電物理組學士班</option>
                                            <option>資訊科學與工程學系學士班</option>
                                            <option>學士後太陽能光電系統應用學士學位學程</option>
                                            <option>機械工程學系學士班</option>
                                            <option>機械工程學系學士班</option>
                                            <option>土木工程學系學士班</option>
                                            <option>土木工程學系學士班</option>
                                            <option>環境工程學系學士班</option>
                                            <option>電機工程學系學士班</option>
                                            <option>電機工程學系學士班</option>
                                            <option>化學工程學系學士班</option>
                                            <option>材料科學與工程學系學士班</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="v_level" class="col-xs-2 control-label">年級</label>
                                    <div class="col-xs-10">
                                        <select class="form-control" name="v_level" id="v_level">
                                            <option value="0">請選擇年級</option>
                                            <option value="1">一年級</option>
                                            <option value="2">二年級</option>
                                            <option value="3">三年級</option>
                                            <option value="4">四年級</option>
                                            <option value="5">五年級</option>
                                        </select>
                                    </div>
                                </div>
                            </form>
                        </div>

                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                            <button type="button" class="btn btn-success" data-dismiss="modal" id="specific_search">Submit</button>
                        </div>
                        </div>
                    </div>
                </div>

                <div class="modal fade modal fade bs-example-modal-lg" id="search" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                    <div class="modal-dialog modal-lg">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                                <h3 class="modal-title" id="myModalLabel"><span class="fa fa-search fa-1x fa-fw"></span>課程查詢</h3>
                            </div>
                            
				        <div class="modal-body">
				            <form class="form-horizontal">
				                <div class="form-group">
				                    <label for="v_career" class="col-xs-2 control-label">學制</label>
				                    <div class="col-xs-10">
				                        <select class="form-control" name="v_career" id="v_career">
				                            <option value="0">請選擇學制</option>
				                            <option value="U">學士班</option>
				                            <option value="G">碩士班</option>
				                            <option value="D">博士班</option>
				                            <option value="R">產專班</option>
				                            <option value="W">碩專班</option>
				                            <option value="N">進修學士班</option>
				                        </select>
				                    </div>
				                </div>
				                <div class="form-group">
				                    <label for="v_major" class="col-xs-2 control-label">系所</label>
				                    <div class="col-xs-10">
				                        <select class="form-control" name="v_major" id="v_major">
				                            <option>請選擇系所</option>
                                            <option>文學院</option>
                                            <option>管理學院</option>
                                            <option>農業暨自然資源學院</option>
                                            <option>中國文學系學士班</option>
                                            <option>外國語文學系學士班</option>
                                            <option>歷史學系學士班</option>
                                            <option>財務金融學系學士班</option>
                                            <option>企業管理學系學士班</option>
                                            <option>法律學系學士班</option>
                                            <option>會計學系學士班</option>
                                            <option>資訊管理學系學士班</option>
                                            <option>景觀與遊憩學士學位學程</option>
                                            <option>生物科技學士學位學程</option>
                                            <option>國際農企業學士學位學程</option>
                                            <option>農藝學系學士班</option>
                                            <option>園藝學系學士班</option>
                                            <option>森林學系林學組學士班</option>
                                            <option>森林學系木材科學組學士班</option>
                                            <option>應用經濟學系學士班</option>
                                            <option>植物病理學系學士班</option>
                                            <option>昆蟲學系學士班</option>
                                            <option>動物科學系學士班</option>
                                            <option>獸醫學系學士班</option>
                                            <option>獸醫學系學士班</option>
                                            <option>土壤環境科學系學士班</option>
                                            <option>生物產業機電工程學系學士班</option>
                                            <option>水土保持學系學士班</option>
                                            <option>食品暨應用生物科技學系學士班</option>
                                            <option>行銷學系學士班</option>
                                            <option>化學系學士班</option>
                                            <option>生命科學系學士班</option>
                                            <option>應用數學系學士班</option>
                                            <option>應用數學系學士班</option>
                                            <option>物理學系一般物理組學士班</option>
                                            <option>物理學系光電物理組學士班</option>
                                            <option>資訊科學與工程學系學士班</option>
                                            <option>學士後太陽能光電系統應用學士學位學程</option>
                                            <option>機械工程學系學士班</option>
                                            <option>機械工程學系學士班</option>
                                            <option>土木工程學系學士班</option>
                                            <option>土木工程學系學士班</option>
                                            <option>環境工程學系學士班</option>
                                            <option>電機工程學系學士班</option>
                                            <option>電機工程學系學士班</option>
                                            <option>化學工程學系學士班</option>
                                            <option>材料科學與工程學系學士班</option>
				                        </select>
				                    </div>
				                </div>
				                <div class="form-group">
				                    <label for="v_level" class="col-xs-2 control-label">年級</label>
				                    <div class="col-xs-10">
				                        <select class="form-control" name="v_level" id="v_level">
				                        	<option value="0">請選擇年級</option>
				                            <option value="1">一年級</option>
				                            <option value="2">二年級</option>
				                            <option value="3">三年級</option>
				                            <option value="4">四年級</option>
				                            <option value="5">五年級</option>
				                        </select>
				                    </div>
				                </div>
				                <div class="form-group">
				                    <label for="class_credit" class="col-xs-2 control-label">學分數</label>
				                    <div class="col-xs-10">
				                        <input type="teacher" class="form-control" id= value="0" readonly><!--不讓使用者自己改學分數-->
				                    </div>
				                </div>
				                <div class="form-group">
				                    <label for="class_title" class="col-xs-2 control-label">課程名稱</label>
				                    <div class="col-xs-10">
				                        <input type="class" class="form-control" id="class_title">
				                    </div>
				                </div>
				                <div class="form-group">
				                    <label for="class_code" class="col-xs-2 control-label">課程代碼</label>
				                    <div class="col-xs-10">
				                        <input type="class" class="form-control" id="class_code">
				                    </div>
				                </div>
				                <div class="form-group">
				                    <label for="class_teacher" class="col-xs-2 control-label">授課教師</label>
				                    <div class="col-xs-10">
				                        <input type="teacher" class="form-control" id="class_teacher">
				                    </div>
				                </div>
				                <div class="form-group">
				                    <label for="class_room" class="col-xs-2 control-label">上課教室</label>
				                    <div class="col-xs-10">
				                        <input type="teacher" class="form-control" id="class_room">
				                    </div>
				                </div>
				                <div class="form-group">
				                    <label class="col-xs-12 control-label" style="text-align: center;">欄位留白表示該條件不設限制</label>
				                </div>
				                <div class="form-group">
				                    <a class="btn btn-lg col-sm-3 col-sm-offset-1" href="https://onepiece.nchu.edu.tw/cofsys/plsql/crseqry_home" target="_blank"><span class="fa fa-graduation-cap fa-1x fa-fw"></span>選課系統</a>
				                    <a class="btn btn-lg col-sm-3" href="http://cah.nchu.edu.tw/class/class_plan.php?new=Y&d_id=3" target="_blank"><span class="fa fa-book fa-1x fa-fw"></span>通識中心</a>
				                    <a class="btn btn-lg col-sm-3" href="https://nchu-am.nchu.edu.tw/nidp/idff/sso?id=3&sid=0&option=credential&sid=0" target="_blank"><span class="fa fa-external-link fa-1x fa-fw"></span>單一簽入</a>
				                </div>
				            </form>
				        </div>

                        <div class="modal-footer">
                            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                            <button type="button" class="btn btn-success" data-dismiss="modal" id="specific_search">Submit</button>
                        </div>
                        </div>
                    </div>
  	            </div>
            </div>
            <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
            <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
            <script src="bootstrap/js/bootstrap.min.js"></script>
		<script>
		(function($){
		//先定義JQuery為$，不要讓它衝突
		//var courses = null;
			$(function(){
				//當文件準備好的時候，讀入json檔
				$.getJSON('json/proto-course.json', function(json){  //getJSON會用function(X)傳回X的物件或陣列
					window.credits=0//一開始的學分數是0
					window.courses = {};//宣告一個空的物件
					window.course_of_majors = {};//宣告一個空的物件
					window.course_of_day = {};	//這是宣告日期的陣列
					window.teacher_course = {};	//這是以老師姓名為index的陣列
					window.name_of_course = {};	//這是以課程名稱為index的陣列
					window.name_of_optional_obligatory = [] //這是用來存系上的必修課，檢查有沒有課名是重複的，若有就讓使用者自行決定要上哪堂
					window.language="zh_TW";//固定顯示語言為中文
					$.each(json.course, function(ik, iv){
						if(typeof(window.course_of_majors[iv.for_dept]) == 'undefined')//如果這一列(列的名稱為索引值key)是空的也就是undefined，那就對他進行初始化，{}物件裡面可以放任意的東西，在下面會把很多陣列塞進這個物件裡面
							window.course_of_majors[iv.for_dept] = {};  
						if(typeof(window.course_of_majors[iv.for_dept][iv.class]) == 'undefined'){
							window.course_of_majors[iv.for_dept][iv.class] = [];//如果這一行(列的名稱為索引值key)是空的也就是undefined，那就對他進行初始化，[]裡面的是放陣列
						}
						window.course_of_majors[iv.for_dept][iv.class].push(iv.code);//把東西推進這個陣列裡，概念跟stack一樣
						window.courses[iv.code] = iv;//這邊可以直接把選課號當作索引值key，裡面的值為object
						$.each(iv.time_parsed, function(jk, jv){//建立日期的陣列				
							$.each(jv.time, function(mk, mv){
								if(typeof(window.course_of_day[jv.day])=='undefined'){
									window.course_of_day[jv.day]={};
								}
								if(typeof(window.course_of_day[jv.day][mv])=='undefined'){
									window.course_of_day[jv.day][mv]=[];
								}
								window.course_of_day[jv.day][mv].push(iv);
							})
						})		
						if(typeof(window.teacher_course[iv.professor])=='undefined'){//建立老師名稱的陣列
							window.teacher_course[iv.professor]=[];
						}
						window.teacher_course[iv.professor].push(iv);	
						if(typeof(window.name_of_course[iv.title_parsed.zh_TW])=='undefined'){//中文課名陣列
							window.name_of_course[iv.title_parsed.zh_TW]=[];
						}																				
						window.name_of_course[iv.title_parsed.zh_TW].push(iv);
						if(typeof(window.name_of_course[iv.title_parsed.en_US])=='undefined'){//英文課名陣列
							window.name_of_course[iv.title_parsed.en_US]=[];
						}																				
						window.name_of_course[iv.title_parsed.en_US].push(iv);
					});					
				});/*
				$("#v_career").change(function()
				{
					select_degree($("#v_career").val());
				});
				var select_degree = function(degree)
				{
					cozsnsole.log(degree);
					switch(degree)
					{
						case "U":

						case "G":

						case "D":

						case "R":

						case "W":

						case "N":
					}
<<<<<<< HEAD
				};	*/
				/*//這段是均民的原始碼
				var serializearray=function(){//比較好的方法來取option 的value!!!!
					$a = $($0)//取到年級選單
					//[<form class=​"form-horizontal">​…​</form>​]
					$a.serializeArray()
					[Objectname: "v_year"value: "103_2"__proto__: Object, Objectname: "v_career"value: "U"__proto__: Object, Objectname: "v_major"value: "C10"__proto__: Object, Objectname: "v_level"value: "1"__proto__: Object]
					$a.serializeArray()[0].name
					"v_year"
					$a.serializeArray()[1].value
					"U"
				}*/	
				$("#bulletin-post").delegate("h5", "click", function(){//delegate可以去抓到還不存在的東西，第一個$()是指作用的區域，delegate的()裡面就是option，dblclick是事件
					var boolean = confirm("確認添加此課程?" + "\n" + "Are you sure to enroll this class?");
					if(boolean){				
						var code = $(this).val();//this會代表我抓到的那個東西，也就是option
						course = courses[code];
						add_course($('#time-table'), course, language);	
						change_color($(this));//選過的課程就會改顏色
					}
				});				
				$("#specific_search").click(function()	//可以用課號搜尋，把input的的課號用.val()取出
				//$("#ok-button").click(function()
				{
					var major=$("#v_major").val();	//取到系
					var level = $("#v_level").val();	//取到年級
					reset();/*						
					var tableArray={1:[1,2,3,4,5,6,7,8],2:[1,2,3,4,5,6,7,8],3:[1,2,3,4,5,6,7,8],4:[1,2,3,4,5,6,7,8],5:[1,2,3,4,5,6,7,8]}				
					$.each(tableArray,function(ik,iv){
						$.each(iv,function(jk,jv){
							var $td = $("#time-table").find('tr[data-hour=' + jv + '] td[data-day='+ik+']');		
							$td.html('<center><button type="button" class="btn btn-info btn-block plusIcon"><span class="fa fa-plus-circle fa-3x fa-fw "></span></button></center>');
						})						
					})*/
					$("td").html('<center><button type="button" class="btn btn-info btn-block plusIcon"><span class="fa fa-plus-circle fa-3x fa-fw "></span></button></center>');
					$.each(course_of_majors[major][level], function(ik, iv){//先這一年級的必修課全部跑過一次，計算重複課名的數量
						if(courses[iv].obligatory_tf==true){
							check_optional_obligatory(courses[iv]);	
						}
					});
					$.each(course_of_majors[major][level], function(ik, iv){//知道那些課程會重複之後，再決定那些課程要填入課表
						var tmpCh = courses[iv].title_parsed["zh_TW"].split(' ');		//(這是中文課名)切割課程名稱，遇到空格就切開
						title_short = tmpCh[0];		//title_short是會自動宣告的區域變數，存沒有英文的課名
						if(window.name_of_optional_obligatory[title_short]==1){
							add_course($('#time-table'), courses[iv], language);
						}		
						show_optional_obligatory(courses[iv]);		
					});
					$.each(course_of_majors[major], function(ik, iv){				
						$.each(iv,function(jk, jv){	
							if(courses[jv].obligatory_tf==false){
								if(courses[jv].class==1){
									bulletin_post($("#freshman"),courses[jv], language);
								}
								if(courses[jv].class==2){
									bulletin_post($("#sophomore"),courses[jv], language);
								}
								if(courses[jv].class==3){
									bulletin_post($("#junior"),courses[jv], language);
								}
								if(courses[jv].class==4){
									bulletin_post($("#senior"),courses[jv], language);
								}
								if(courses[jv].class==5){
									bulletin_post($("#fifth-grade"),courses[jv], language);
								}
							}						
						})
					})//以上為必修 選修填入	
					//可以用課號搜尋，把input的的課號用.val()取出
					var code = $("#class_code").val();	//課號搜尋
					if(code!=""){
						bulletin_post($("#specific-post"),courses[code], language);
					}		
					var class_title=$("#class_title").val();//課程名稱搜尋
					if(class_title!=""){
						$.each(name_of_course, function(ik, iv){
							if(ik.search(class_title)!=-1){
								$.each(iv,function(jk, jv){
									bulletin_post($("#specific-post"),jv, language);
								});
							}							
						})												
					}	
					var teacher = $("#class_teacher").val();//老師名稱搜尋
					if(teacher!=""){
						$.each(teacher_course[teacher], function(ik, iv){							
							bulletin_post($("#specific-post"),iv, language);
						});
					}
				});

				$("#clear-button").click(function()
				{
					$('#time-table td').empty(); //把目前的time-table清空，好讓下個年級的課程能夠乾淨的顯示
					$('#bulletin_post').empty();//清掉選修課程
					$("td").html('<center><button type="button" class="btn btn-info btn-block plusIcon"><span class="fa fa-plus-circle fa-3x fa-fw "></span></button></center>');//再把加號的按鈕填上去
				});
				$("#time-table").delegate("span.delete", "click", function(){//這是用來把一整個課程都刪掉的按鈕
					$target = $(this).closest("td");//因為這裡點到的是span，要往上找td
					var code = $(this).next("input").val();//找到最近的一個sibling,可以用selector去篩選
					var boolean = confirm("是否刪除此課程?" + "\n" + "Are you sure you really want to drop this course?");					
					if(boolean)
					{
						delete_course($('#time-table'), courses[code]);	//就跟add_course一樣，只是把填東西改成刪掉				
					}					
				});								
				$("#time-table").delegate("button.plusIcon","click",function(){	//按一下課表欄位就有課程彈出來了
					if($(this).text()==""){ //我現在才知道null!=""
						var major=$("#v_major").val();	//取到系
						var day=$(this).closest("td").attr("data-day");
						var hour=$(this).closest("tr").attr("data-hour");	
						$("#specific-time-post").empty();
						$.each(course_of_day[day][hour], function(ik, iv){	
							if(iv.for_dept==major){//判斷如果不是這個系的課就不要顯示出來，以後應該可以再按照系級進化陣列
								bulletin_post($("#specific-time-post"),course_of_day[day][hour][ik], language);	//因為我把同一時段的課程塞進陣列裡，所以要用index去取
							}											
						})					
					}					
				});/*
				$("#obligatory-check").change(function(){//用來檢查勾選表被選了沒
					if ($(this).prop("checked")){//如果選了，就設定成隱藏的css屬性
						$("#obligatory-post").css("display", "");						
					};
					if($(this).prop("checked")==false){//如果沒有就恢復成空的
						$("#obligatory-post").css("display", "none");
					}
				});		*/		
				$(document).ready(function(){
				    $('[data-toggle="tooltip"]').tooltip();				   					
					$("[data-toggle='tooltip']").on('hover', function(){
        				$(this).tooltip({title: "Hooray!", trigger: "hover"}); 
    				});			
				});				
			});
			
			window.week = ["一", "二", "三", "四", "五"];
			/************這是用來把課程放到右邊的欄位**************/
			var bulletin_post = function($target,course, language){	
			 	if( $.type(course.title_parsed)!=="object" )			//判斷課程名稱是不是物件
					throw 'title_parsed error';
				var time = [];//time設定為空陣列
				var $td;
				time.push("上課時間:");
				$.each(course.time_parsed, function(ik, iv){		
					time.push("星期"+week[iv.day-1]+iv.time);//push是把裡面的元素變成陣列的一格		
				})
				time = time.join(' ');//把多個陣列用;分隔並合併指派給time
				//var time = course.time_parsed.day+course.time_parsed.time;
				var $option = $($.parseHTML('<button type="button" class="btn btn-default" data-toggle="tooltip" data-placement="bottom" style="color:#3074B5;" title="" value=""></button>'));//把option做成dom，再把dom做成jQuery物件
				//<button type="button" class="btn btn-default" data-toggle="tooltip" data-placement="left" >Tooltip on left</button>
				$option.text(course.title_short);	//將對應的課程內容寫入cell的html語法中	
				$option.attr("data-toggle", time);	//在title裡面放課堂時間
				$option.val(course.code);
				//把現在找到的這門選修課課程代碼儲存到這個option，並用value表示
				$target.append($option);		//顯示課程，把$option放到elective-post，append是追加在後面
			};
			var add_course = function($target, course, language) {		//假設target為time-table的參數，course為courses的某一個課程
				if( !$.isArray(course.time_parsed) )
					throw 'time_parsed error';		//判斷time-parsed是不是陣列
				if( $.type(course.title_parsed)!=="object" )			//判斷課程名稱是不是物件
					throw 'title_parsed error';
				if(language == "zh_TW"){
					var tmpCh = course.title_parsed["zh_TW"].split(' ');		//(這是中文課名)切割課程名稱，遇到空格就切開
					course.title_short = tmpCh[0];		//title_short是會自動宣告的區域變數，存沒有英文的課名			  	
				}
				else{
					var tmpEn = course.title_parsed["en_US"];
					course.title_short = tmpEn;			  	
				}						
				var check_conflict = false;	//他用來判斷是否衝堂，如果有則下面的if就會讓最外圈的each停止
				$.each(course.time_parsed,function(ik, iv){
					$.each(iv.time,function(jk, jv){
						var $td = $target.find('tr[data-hour=' + jv + '] td:eq(' + (iv.day-1) + ')');
						if($td.text()!=""){//用來判斷td裡面是不已經有放過課程了，但若先在裡面放個按鈕那.text()回傳回來的也是空字串					
							check_conflict = true;
							alert("衝堂喔!請手動刪除衝堂的課程"+"\n"+"opps!You are not available at that 	time! Please drop out some class");
							return false;//傳回false就是跳離迴圈
						}	
					});
					if(check_conflict==true){
						return false;
					}
				});
				if(check_conflict==false){
					$.each(course.time_parsed, function(ik, iv){							
						$.each(iv.time, function(jk, jv){		//同上，iv.	time為"time"的陣列{3,4}，jk為0~1、jv為3~4(節數)					
							var $td = $target.find('tr[data-hour=' + jv + '] td:eq(' + (iv.day-1) + ')');	
						  var $cell = $($.parseHTML('<div><div><button type="button" class="close" data-dismiss="alert" aria-label="Close" style="color:red;"><span aria-hidden="true" class="delete" style="color:red;">&times;</span><input type="hidden" name="code-of-course" value=""></button></div><div class="title"></div><div class="row"><div class="professor col-xs-6"></div><div class="location col-xs-6"></div>'));
							//把上面的html格式匯入找到的td type中(	parseHtml把後面的包裝成dom，再用一個$包裝成jQuery物件)
							$cell.find('.title').text(course.title_short).end()
							$cell.find('input').val(course.code).end()		//	將對應的課程內容寫入cell的html語法中，.title就是class="title"
							     .find('.professor').text(course.professor).end()//text()	會把東西填入找到的class那裡，end()會回到var $cell那一行
							     .find('.location').text(course.location);								
							$td.html($cell.html());		//顯示課程，把cell.html()塞到<td>tag裡面，就算裡面原本有按鈕也會直接被蓋掉
						});
					});
					add_credits(course);
				}
				
			};
            /**********刪除課程搜尋結果**********/
            $("#bulletin-post .panel-heading").click(function(){
                console.log("click");
            });

			/**********這是用來刪除衝堂的課程***********/
			var delete_conflict = function($target, course, stop_day, stop_time) {		
			//假設target為time-table的參數，course為courses的某一個課程
				$.each(course.time_parsed, function(ik, iv){
					//each是for迴圈 time-parsed[{...}, {...}]，以微積分為例:一個{"day"+"time"}就是陣列的一格，所以ik為0~1(兩次)	
					var already_delete = false;
					if(already_delete){
						return false;
					}
					$.each(iv.time, function(jk, jv){		//同上，iv.time為"time"的陣列{3,4}，jk為0~1、jv為3~4(節數)
						if(iv.day==stop_day&&jv==stop_time){
							already_delete=true;
							return false;
						}
						//console.log("刪掉了"+iv.day+" "+jv+" ");
						var $td = $target.find('tr[data-hour=' + jv + '] td:eq(' + (iv.day-1) + ')');	
						//td:eq()為搜尋td的陣列索引值，找到課程的時間	iv.day為星期，但因為td為陣列所以iv.day要減一	 find()是找class!!	
						//console.log($td);			
						$td.empty();	//顯示課程，把cell.html()塞到<td>tag裡面
					})
				})
			};

			/**********這個函式是用來刪除一整門課程的**********/
			var delete_course = function($target, course) {
			//假設target為time-table的參數，course為courses的某一個課程				
				$.each(course.time_parsed, function(ik, iv){
				//each是for迴圈 time-parsed[{...}, {...}]，以微積分為例:一個{"day"+"time"}就是陣列的一格，所以ik為0~1(兩次)
					$.each(iv.time, function(jk, jv){		//同上，iv.time為"time"的陣列{3,4}，jk為0~1、jv為3~4(節數)
						var $td = $target.find('tr[data-hour=' + jv + '] td:eq(' + (iv.day-1) + ')');	
						//td:eq()為搜尋td的陣列索引值，找到課程的時間	iv.day為星期，但因為td為陣列所以iv.day要減一	 find()是找class!!
						$td.empty();	//顯示課程，把cell.html()塞到<td>tag裡面
						$td.html('<center><button type="button" class="btn btn-info btn-block plusIcon"><span class="fa fa-plus-circle fa-3x fa-fw "></span></button></center>');
					})
				})
				minus_credits(course);
			};
			var add_credits = function(course){//增加學分
				window.credits+=parseInt(course.credits);//要先把字串型態的學分轉成int才能做加減
				$("#class_credit").text(window.credits);
			};
			var minus_credits = function(course){
				window.credits-=parseInt(course.credits);
				$("#class_credit").val(window.credits);
			};
			var reset=function(){
				$('#time-table td').empty(); //把目前的time-table清空，好讓下個年級的課程能夠乾淨的顯示
				$('#freshman').empty();//以下是要清掉選修課程、指定時間搜尋等課程
				$('#sophomore').empty();
				$('#senior').empty();
				$('#junior').empty();
				$('#fifth-grade').empty();
				$('#specific-time-post').empty();
				$('#specific-post').empty();
				$('#general-post').empty();
				$('#PE-post').empty();
				window.credits=0;
				$("#class_credit").val(window.credits);
				window.name_of_optional_obligatory=[];//把數過的課程清空
			}	 
			var change_color=function($target){//一旦添加了課程，則側欄的課名改了顏色	
				$target.css("color","red");
			} 
			var check_optional_obligatory=function(course){//用來確認這個戲有幾堂必修課是同名的
				var tmpCh = course.title_parsed["zh_TW"].split(' ');		//(這是中文課名)切割課程名稱，遇到空格就切開
				course.title_short = tmpCh[0];		//title_short是會自動宣告的區域變數，存沒有英文的課名
				if(typeof(window.name_of_optional_obligatory[course.title_short]) == 'undefined'){//如果這一列(列的名稱為索引值key)是空的也就是undefined，那就對他進行初始化，{}物件裡面可以放任意的東西，在下面會把很多陣列塞進這個物件裡面
					window.name_of_optional_obligatory[course.title_short] = 1;
				}
				else{
					window.name_of_optional_obligatory[course.title_short]++;
				}			
				console.log(course.title_short+" "+window.name_of_optional_obligatory[course.title_short]);
			} 
			var show_optional_obligatory=function(course){
				var tmpCh = course.title_parsed["zh_TW"].split(' ');		//(這是中文課名)切割課程名稱，遇到空格就切開
				course.title_short = tmpCh[0];		//title_short是會自動宣告的區域變數，存沒有英文的課名
				if(window.name_of_optional_obligatory[course.title_short]>1){
					bulletin_post($("#obligatory-post"),course,language);
				}
			}
			
		})(jQuery);
	    </script>
        </body>
    </html>
